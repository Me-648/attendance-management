<% if Rails.env.development? %>
  <div class="fixed top-0 left-0 w-full bg-yellow-100 border-b border-yellow-300 p-2 z-50 flex items-center justify-between shadow-sm text-sm">
    <div class="flex items-center gap-2">
      <span class="font-bold text-yellow-800">ðŸ›  Time Travel:</span>
      <span class="text-gray-800 font-mono"><%= Time.current.strftime("%Y-%m-%d %H:%M:%S") %></span>
      <% if session[:virtual_time].present? %>
        <span class="bg-red-500 text-white text-xs px-2 py-0.5 rounded">Active</span>
      <% end %>
    </div>
    
    <%= form_with url: student_development_time_travel_path, method: :post, class: "flex items-center gap-2", local: true do |f| %>
      <%= f.datetime_local_field :virtual_time, value: Time.current.strftime("%Y-%m-%dT%H:%M"), class: "px-2 py-1 text-xs border rounded" %>
      <%= f.button "Set", name: "commit", value: "set", class: "bg-yellow-500 text-white px-3 py-1 rounded text-xs hover:bg-yellow-600" %>
      <%= f.button "Reset", name: "virtual_time", value: "", class: "bg-gray-500 text-white px-3 py-1 rounded text-xs hover:bg-gray-600" %>
    <% end %>
  </div>
<% end %>

<div class="min-h-screen bg-body pt-8 pb-24 w-full flex justify-center">
    <div class="w-full max-w-5xl" 
      data-controller="tabs attendance-modal"
      data-tabs-default-tab-value="register"
      data-tabs-active-class="text-brown font-bold"
      data-tabs-inactive-class="text-brown opacity-70">

    <!-- Mobile Tabs (mdä»¥ä¸Šã§éžè¡¨ç¤º) -->
    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-brown px-2 py-2 z-50 text-sm">
      <nav class="flex justify-around w-full items-center gap-4" aria-label="Tabs">
        <a href="#" class="flex-1 text-center py-3 px-4 rounded-full transition-all duration-200 flex items-center justify-center gap-2 bg-ivory"
            data-tabs-target="tab" 
            data-action="tabs#switch" 
            data-tab-id="register">
          <span class="text-sm whitespace-nowrap">å‡ºå¸­ç™»éŒ²</span>
          <%= image_tag "paw.svg", class: "w-4 h-4 hidden", data: { tabs_target: "icon" } %>
        </a>
        <a href="#" class="flex-1 text-center py-3 px-4 rounded-full transition-all duration-200 flex items-center justify-center gap-2 bg-ivory"
            data-tabs-target="tab" 
            data-action="tabs#switch" 
            data-tab-id="history">
          <span class="text-sm whitespace-nowrap">ç´¯è¨ˆä¸€è¦§</span>
          <%= image_tag "paw.svg", class: "w-4 h-4 hidden", data: { tabs_target: "icon" } %>
        </a>
      </nav>
    </div>

    <!-- ç®¡ç†è€…ç”¨ã¸ãƒœã‚¿ãƒ³ (å·¦ä¸‹ãƒ»å›ºå®š) -->
    <div class="fixed bottom-24 left-4 md:hidden z-0">
      <%= link_to "ç®¡ç†è€…ç”¨ã¸", "#", class: "bg-[#D1D5DB] text-[#4B5563] text-xs px-4 py-2 rounded-full shadow-sm font-bold opacity-90 hover:opacity-100 transition-opacity" %>
    </div>

    <div class="space-y-8">
      <!-- ä¸Šæ®µ: æœ¬æ—¥ã®å‡ºå¸­ç™»éŒ² -->
      <div data-tabs-target="panel" data-tab-id="register" class="md:block">
        <%= render "attendance_form", periods: @facade.periods, today_attendances: @facade.today_attendances %>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
        <!-- ä¸‹æ®µå·¦: å¹´é–“ç´¯è¨ˆ -->
        <div data-tabs-target="panel" data-tab-id="register" class="md:block h-full">
          <%= render "attendances/year_summary_stats", stats: @facade.stats %>
        </div>

        <!-- ä¸‹æ®µå³: å‡ºå¸­ä¸€è¦§ -->
        <div data-tabs-target="panel" data-tab-id="history" class="hidden md:block h-full">
          <%= render "monthly_attendance_history", facade: @facade %>
        </div>
      </div>
    </div>
  </div>
</div>
