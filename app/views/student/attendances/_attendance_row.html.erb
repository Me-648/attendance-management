<%= turbo_frame_tag "attendance_period_#{period.id}", class: "w-full" do %>
  <div class="grid grid-cols-4 gap-2 w-full">
    <% # 現在のステータス %>
    <% current_status = attendance&.status %>
    
    <!-- 出席ボタン -->
    <% if attendance_disabled?(period, :attended) && current_status != 'attended' %>
      <div class="w-full">
        <button type="button" disabled class="<%= attendance_status_classes(false, :attended, false) %> opacity-50 cursor-not-allowed w-full">
          出席
        </button>
      </div>
    <% else %>
      <div class="w-full">
        <%= button_to "出席", attendance&.persisted? ? student_attendance_path(attendance) : student_attendances_path, 
              method: attendance&.persisted? ? :patch : :post,
              params: { attendance: { period_id: period.id, status: :attended } },
              class: attendance_status_classes(current_status == 'attended', :attended, true) + " w-full",
              disabled: (current_status == 'attended')
        %>
      </div>
    <% end %>

    <!-- その他のボタン -->
    <% [:absent, :late, :officially_absent].each do |status| %>
      <div class="w-full">
        <%= link_to attendance_label(status),
              form_student_attendances_path(period_id: period.id, status: status),
              class: attendance_status_classes(current_status == status.to_s, status) + " w-full block",
              data: { turbo_frame: "modal" }
        %>
      </div>
    <% end %>
  </div>
<% end %>
